"""date updated: 04/07/2021"""import pandas as pdimport os# to convert list as string to listimport ast# path to data (business.xlsx)data_path = '../../dataset_ignore/businesses.xlsx'output_path = '../../datasets_clean/businesses_sanitized.csv'# columns to keep in dataframe# business type columns: F,G,Q,AB,AT# final location data: BB:BEcolumns = 'F,G,Q,AB,AT,BB:BE'def fix_types(value):    '''    takes:        value - string possibly containing list            returns:        list with data from value        '''        if isinstance(value, str) and (value[0] == '['):        fixed = ast.literal_eval(value)            else:        fixed = [value]            new_fixed = [x.lower() for x in fixed if str(x) != 'nan']        return new_fixeddef list_sum(row):    '''    takes:        row - pandas dataframe row consisting of lists            returns:        concatenated list of all lists    '''    concatenated = []        for item in row:        concatenated.extend(item)        return concatenated    def combine_types(df, selection):    '''    takes:        df - a pandas dataframe        selection - list of columns to combine, default none    returns:        dataframe with selected columns combined into 'type'            used to concatenate type classifications from different sites in dataset    '''        # columns to leave alone    unchanged = [x for x in df.columns.tolist() if x not in selection]        # initializing new df and df to facilitate combining    new_df = df[unchanged]    types = df[selection]        # change strings to lists, combine into one column    fixed = types.applymap(fix_types)        # column with list of types    new_df.insert(len(new_df.columns),'types',fixed.sum(axis=1))        return new_df# pulling data from excel fileif os.path.exists(data_path):    print('acquiring data...')    raw = pd.read_excel(data_path, usecols=columns)        # renaming for convenience    raw.columns = ['bing_type1','bing_type2','google_type','yelp_type','yp_type',                   'name','zip','lon','lat']        # reordering for convenience    raw = raw[['name','zip','lon','lat',               'bing_type1','bing_type2','google_type','yelp_type','yp_type']]        # combining types    print('cleaning...')    type_names = ['bing_type1','bing_type2','google_type','yelp_type','yp_type']    cleaned = combine_types(raw, type_names)        # output clean data as csv    print('outputting...')    cleaned.to_csv(output_path)    print('done')    # rejects if path has been changedelse:    raise FileNotFoundError('invalid path to businesses.xlsx')