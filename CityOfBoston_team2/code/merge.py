"""date updated: 04/07/2021"""#%% packagesimport pandas as pdimport os#%% import# change to datasets_clean directoryos.chdir('../datasets_clean')# pathsbusinesses_path = 'businesses_sanitized.csv'parcels_path = 'p_businesses_latlon.csv'food_path = 'food_retailers_sanitized.csv'schools_path = 'schools_latlon.csv'pharma_path = 'pharmacies_sanitized.csv'hospital_path = 'hospitals_latlon.csv'farmers_path = 'farmers_sanitized.csv'all_paths = [businesses_path,             parcels_path,             food_path,             schools_path,             pharma_path,             hospital_path,             farmers_path]# empty variables for iterationvariables = list(range(7))# importif all(os.path.exists(path) for path in all_paths):    for i in range(len(all_paths)):        print('acquiring data from:', all_paths[i])        variables[i] = pd.read_csv(all_paths[i])        print('columns:')        print(variables[i].columns)        print()        # rejects if any path has been changedelse:    raise FileNotFoundError('at least one invalid path')    businesses = variables[0]parcels = variables[1]food = variables[2]schools = variables[3]pharma = variables[4]hospital = variables[5]farmers = variables[6]print('done importing.')    #%% standardizating columnsprint('standardizing columns...')businesses = businesses[['name', 'zip', 'lat', 'lon', 'category']]parcels = parcels[['name', 'zip', 'lat', 'lon', 'category', 'address']]food = food[['name', 'zipcode', 'latitude', 'longitude', 'buisness_type', 'address']]schools = schools[['name', 'zip', 'lat', 'lon', 'address']]pharma = pharma[['NAME', 'ZIP', 'latitude',  'longitude', 'buisness_type', 'ADDRESS']]hospital = hospital[['name', 'zip', 'lat', 'lon', 'category', 'address']]farmers = farmers[['NAME', 'LATITUDE', 'LONGITUDE', 'buisness_type', 'ADDR_1']]# fixing missing columnsbusinesses.insert(5, 'address', float('nan'))schools.insert(4, 'category', 'education')farmers.insert(1, 'zip', float('nan'))# fixing namesvariables = [businesses, parcels, food, schools, pharma, hospital, farmers]for df in variables:    df.columns = ['name', 'zip', 'lat', 'lon', 'category', 'address']#%% merging# mergeprint('merging...')merged = pd.concat(variables)merged.reset_index(drop = True)# helper to standardize category namesdef cat_names(name):    '''    takes: name, a category name as a string    returns: a standardized category name    '''        standard = ['commercial', 'education', 'food', 'health', 'recreation', 'social']        fixed = name.lower()        if fixed in standard:        return fixed        for cat in standard:        if cat in fixed:            fixed = cat            return fixed        raise ValueError('unknown category')    merged['category'] = merged.category.apply(cat_names)# removing na in locationmerged.dropna(subset = ['lat','lon'], inplace = True)#%% outputtingoutput_path = '../datasets_clean/merged.csv'print('outputting...')merged.to_csv(output_path)print('done.')